import{S as Oe,i as Be,s as ze,k as g,q as S,a as P,l as p,m as M,r as C,h as c,c as I,n as z,I as el,b as j,D as o,J as Lt,K as R,B as re,L as $e,M as Re,N as tl,e as et,p as tt,O as $,P as te,o as xt,w as Je,x as Ke,y as Qe,u as be,f as Xe,t as Ye,z as xe,Q as ll}from"../../chunks/index-a8a449af.js";import{_ as nl}from"../../chunks/preload-helper-41c905a7.js";const Dt=function(n,e,l,t,r){const s=(n-e)/(l-e)*(r-t)+t;return t<r?Vt(s,t,r):Vt(s,r,t)},Vt=function(n,e,l){return Math.max(Math.min(n,l),e)},$t=()=>({white:{white:Math.floor(Math.random()*4-1),red:Math.floor(Math.random()*4-1),green:Math.floor(Math.random()*4-1),blue:Math.floor(Math.random()*4-1)},red:{white:Math.floor(Math.random()*4-1),red:Math.floor(Math.random()*4-1),green:Math.floor(Math.random()*4-1),blue:Math.floor(Math.random()*4-1)},green:{white:Math.floor(Math.random()*4-1),red:Math.floor(Math.random()*4-1),green:Math.floor(Math.random()*4-1),blue:Math.floor(Math.random()*4-1)},blue:{white:Math.floor(Math.random()*4-1),red:Math.floor(Math.random()*4-1),green:Math.floor(Math.random()*4-1),blue:Math.floor(Math.random()*4-1)}}),Wt=[{name:"Negs",description:"Only -1",table:{white:{white:-1,red:-1,green:-1,blue:-1},red:{white:-1,red:-1,green:-1,blue:-1},green:{white:-1,red:-1,green:-1,blue:-1},blue:{white:-1,red:-1,green:-1,blue:-1}}},{name:"Infinite motion",description:"Some very simple patterns of reds chasing whites in a seemlingly infinite randomness",table:{white:{white:-1,red:-1,green:0,blue:-1},red:{white:2,red:-1,green:1,blue:-1},green:{white:0,red:0,green:-1,blue:-1},blue:{white:-1,red:-1,green:-1,blue:-1}}},{name:"No cohesion",description:"Cells of the same color repulse each other",table:{white:{white:-1,red:0,green:0,blue:0},red:{white:0,red:-1,green:0,blue:0},green:{white:0,red:0,green:-1,blue:0},blue:{white:0,red:0,green:0,blue:-1}}},{name:"Spray around",description:"All the cells repulse each others, resulting in an even repartition of the cells",table:{white:{white:-1,red:-1,green:-1,blue:-1},red:{white:-1,red:-1,green:-1,blue:-1},green:{white:-1,red:-1,green:-1,blue:-1},blue:{white:-1,red:-1,green:-1,blue:-1}}},{name:"Simple snake",description:"The colors attract each other in a circular manner creating some moving snakes",table:{white:{white:-1,red:1,green:0,blue:0},red:{white:0,red:-1,green:1,blue:0},green:{white:0,red:0,green:-1,blue:1},blue:{white:1,red:0,green:0,blue:-1}}},{name:"Fishes",description:"The cells regroup in moving structures with white/red head and blue/green tail swimming through the world.",table:{white:{white:0,red:1,green:-1,blue:-2},red:{white:2,red:0,green:1,blue:-1},green:{white:-2,red:-2,green:-2,blue:1},blue:{white:2,red:-1,green:1,blue:-2}}},{name:"Movers and stills",description:"Create some moving objects mainly drivent by green and red and some living but still objects made by white, blue and red. Sometimes the movers grab still objects.",table:{white:{white:1,red:-1,green:0,blue:1},red:{white:2,red:1,green:2,blue:-1},green:{white:-1,red:-1,green:1,blue:-1},blue:{white:1,red:2,green:0,blue:0}}},{name:"White pushers",description:"Create movers propelled by groups of white cells",table:{white:{white:1,red:1,green:2,blue:-1},red:{white:0,red:-1,green:2,blue:2},green:{white:-1,red:0,green:-1,blue:2},blue:{white:-1,red:1,green:1,blue:-1}}},{name:"Large vessels",description:"Create large gliders with branches. The cells are ordered white, blue, red green",table:{white:{white:0,red:1,green:0,blue:2},red:{white:0,red:1,green:1,blue:-1},green:{white:-1,red:1,green:0,blue:1},blue:{white:-1,red:2,green:2,blue:2}}},{name:"Universe",description:"Galaxies with blue center, red and white rings turning around evolving in a green goo",table:{white:{white:-1,red:1,green:1,blue:1},red:{white:-1,red:-1,green:-1,blue:2},green:{white:-2,red:-1,green:0,blue:-1},blue:{white:1,red:2,green:-2,blue:2}}}];function jt(n,e,l){const t=n.slice();return t[4]=e[l],t}function qt(n){let e,l=n[4].name+"",t,r,s=n[4].description+"",m,f;return{c(){e=g("option"),t=S(l),r=S(` -
                `),m=S(s),f=P(),this.h()},l(h){e=p(h,"OPTION",{});var _=M(e);t=C(_,l),r=C(_,` -
                `),m=C(_,s),f=I(_),_.forEach(c),this.h()},h(){e.__value=n[4].table,e.value=e.__value},m(h,_){j(h,e,_),o(e,t),o(e,r),o(e,m),o(e,f)},p:re,d(h){h&&c(e)}}}function ol(n){let e,l,t,r,s,m,f,h,_,b=Wt,u=[];for(let v=0;v<b.length;v+=1)u[v]=qt(jt(n,b,v));return{c(){e=g("div"),l=g("label"),t=S("Select a new attraction table"),r=P(),s=g("select"),m=g("option"),f=S("Random - A randomly generated table");for(let v=0;v<u.length;v+=1)u[v].c();this.h()},l(v){e=p(v,"DIV",{});var N=M(e);l=p(N,"LABEL",{for:!0});var T=M(l);t=C(T,"Select a new attraction table"),T.forEach(c),r=I(N),s=p(N,"SELECT",{});var w=M(s);m=p(w,"OPTION",{});var d=M(m);f=C(d,"Random - A randomly generated table"),d.forEach(c);for(let E=0;E<u.length;E+=1)u[E].l(w);w.forEach(c),N.forEach(c),this.h()},h(){z(l,"for","tables"),m.__value=$t(),m.value=m.__value,n[1]===void 0&&el(()=>n[2].call(s))},m(v,N){j(v,e,N),o(e,l),o(l,t),o(e,r),o(e,s),o(s,m),o(m,f);for(let T=0;T<u.length;T+=1)u[T].m(s,null);Lt(s,n[1]),h||(_=[R(s,"change",n[2]),R(s,"change",n[3])],h=!0)},p(v,[N]){if(N&0){b=Wt;let T;for(T=0;T<b.length;T+=1){const w=jt(v,b,T);u[T]?u[T].p(w,N):(u[T]=qt(w),u[T].c(),u[T].m(s,null))}for(;T<u.length;T+=1)u[T].d(1);u.length=b.length}N&2&&Lt(s,v[1])},i:re,o:re,d(v){v&&c(e),$e(u,v),h=!1,Re(_)}}}function rl(n,e,l){let t,{updateTable:r}=e;function s(){t=tl(this),l(1,t)}const m=()=>r(t);return n.$$set=f=>{"updateTable"in f&&l(0,r=f.updateTable)},[r,t,s,m]}class al extends Oe{constructor(e){super(),Be(this,e,rl,ol,ze,{updateTable:0})}}function Ht(n,e,l){const t=n.slice();return t[13]=e[l],t}function Zt(n,e,l){const t=n.slice();t[16]=e[l];const r=t[1].get(t[0][t[13]][t[16]]);return t[17]=r,t}function Gt(n,e,l){const t=n.slice();return t[17]=e[l],t}function Jt(n){let e,l,t,r,s,m,f,h,_,b,u,v,N,T,w,d,E,y=n[2],B=[];for(let k=0;k<y.length;k+=1)B[k]=Kt(Gt(n,y,k));let V=n[2],A=[];for(let k=0;k<V.length;k+=1)A[k]=Xt(Ht(n,V,k));return{c(){e=g("div"),l=g("button"),t=S("Randomize table"),r=P(),s=g("button"),m=S("Zero table"),f=P(),h=g("button"),_=S("Mutate table"),b=P(),u=g("div"),v=g("span"),N=S("Attraction"),T=P();for(let k=0;k<B.length;k+=1)B[k].c();w=P();for(let k=0;k<A.length;k+=1)A[k].c();this.h()},l(k){e=p(k,"DIV",{});var W=M(e);l=p(W,"BUTTON",{});var a=M(l);t=C(a,"Randomize table"),a.forEach(c),r=I(W),s=p(W,"BUTTON",{});var D=M(s);m=C(D,"Zero table"),D.forEach(c),f=I(W),h=p(W,"BUTTON",{});var F=M(h);_=C(F,"Mutate table"),F.forEach(c),W.forEach(c),b=I(k),u=p(k,"DIV",{class:!0});var H=M(u);v=p(H,"SPAN",{});var G=M(v);N=C(G,"Attraction"),G.forEach(c),T=I(H);for(let Z=0;Z<B.length;Z+=1)B[Z].l(H);w=I(H);for(let Z=0;Z<A.length;Z+=1)A[Z].l(H);H.forEach(c),this.h()},h(){z(u,"class","grid5cols svelte-41p0gs")},m(k,W){j(k,e,W),o(e,l),o(l,t),o(e,r),o(e,s),o(s,m),o(e,f),o(e,h),o(h,_),j(k,b,W),j(k,u,W),o(u,v),o(v,N),o(u,T);for(let a=0;a<B.length;a+=1)B[a].m(u,null);o(u,w);for(let a=0;a<A.length;a+=1)A[a].m(u,null);d||(E=[R(l,"click",n[6]),R(s,"click",n[8]),R(h,"click",n[7])],d=!0)},p(k,W){if(W&4){y=k[2];let a;for(a=0;a<y.length;a+=1){const D=Gt(k,y,a);B[a]?B[a].p(D,W):(B[a]=Kt(D),B[a].c(),B[a].m(u,w))}for(;a<B.length;a+=1)B[a].d(1);B.length=y.length}if(W&63){V=k[2];let a;for(a=0;a<V.length;a+=1){const D=Ht(k,V,a);A[a]?A[a].p(D,W):(A[a]=Xt(D),A[a].c(),A[a].m(u,null))}for(;a<A.length;a+=1)A[a].d(1);A.length=V.length}},d(k){k&&c(e),k&&c(b),k&&c(u),$e(B,k),$e(A,k),d=!1,Re(E)}}}function Kt(n){let e,l=n[17]+"",t;return{c(){e=g("button"),t=S(l),this.h()},l(r){e=p(r,"BUTTON",{style:!0});var s=M(e);t=C(s,l),s.forEach(c),this.h()},h(){tt(e,"background-color",n[17]),e.disabled=!0},m(r,s){j(r,e,s),o(e,t)},p:re,d(r){r&&c(e)}}}function Qt(n){let e,l,t,r,s,m,f,h,_,b,u;function v(){return n[10](n[13],n[16])}function N(){return n[11](n[13],n[16])}function T(){return n[12](n[13],n[16])}return{c(){e=g("span"),l=g("button"),t=S("-"),r=P(),s=g("button"),m=P(),f=g("button"),h=S("+"),_=P(),this.h()},l(w){e=p(w,"SPAN",{class:!0});var d=M(e);l=p(d,"BUTTON",{});var E=M(l);t=C(E,"-"),E.forEach(c),r=I(d),s=p(d,"BUTTON",{style:!0}),M(s).forEach(c),m=I(d),f=p(d,"BUTTON",{});var y=M(f);h=C(y,"+"),y.forEach(c),_=I(d),d.forEach(c),this.h()},h(){tt(s,"background-color",n[17]),z(e,"class","grid1row3cols svelte-41p0gs")},m(w,d){j(w,e,d),o(e,l),o(l,t),o(e,r),o(e,s),o(e,m),o(e,f),o(f,h),o(e,_),b||(u=[R(l,"click",v),R(s,"click",N),R(f,"click",T)],b=!0)},p(w,d){n=w,d&1&&tt(s,"background-color",n[17])},d(w){w&&c(e),b=!1,Re(u)}}}function Xt(n){let e,l=n[13]+"",t,r,s,m=n[2],f=[];for(let h=0;h<m.length;h+=1)f[h]=Qt(Zt(n,m,h));return{c(){e=g("button"),t=S(l),r=P();for(let h=0;h<f.length;h+=1)f[h].c();s=et(),this.h()},l(h){e=p(h,"BUTTON",{style:!0});var _=M(e);t=C(_,l),_.forEach(c),r=I(h);for(let b=0;b<f.length;b+=1)f[b].l(h);s=et(),this.h()},h(){tt(e,"background-color",n[13]),e.disabled=!0},m(h,_){j(h,e,_),o(e,t),j(h,r,_);for(let b=0;b<f.length;b+=1)f[b].m(h,_);j(h,s,_)},p(h,_){if(_&63){m=h[2];let b;for(b=0;b<m.length;b+=1){const u=Zt(h,m,b);f[b]?f[b].p(u,_):(f[b]=Qt(u),f[b].c(),f[b].m(s.parentNode,s))}for(;b<f.length;b+=1)f[b].d(1);f.length=m.length}},d(h){h&&c(e),h&&c(r),$e(f,h),h&&c(s)}}}function sl(n){let e,l=n[0]&&Jt(n);return{c(){l&&l.c(),e=et()},l(t){l&&l.l(t),e=et()},m(t,r){l&&l.m(t,r),j(t,e,r)},p(t,[r]){t[0]?l?l.p(t,r):(l=Jt(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:re,o:re,d(t){l&&l.d(t),t&&c(e)}}}function il(n,e,l){let{attractionTable:t}=e,{onUpdateTable:r}=e;const s=new Map([[-2,"#ff0000"],[-1,"#ff7d7d"],[0,"#000000"],[1,"#7dff7d"],[2,"#00ff00"]]),m=["white","red","green","blue"],f=(d,E)=>{let y=t[d][E];y++,y===3&&(y=-2),l(0,t[d][E]=y,t),r(t)},h=(d,E)=>{let y=t[d][E];y++,y===3&&(y=2),l(0,t[d][E]=y,t),r(t)},_=(d,E)=>{let y=t[d][E];y--,y===-3&&(y=-2),l(0,t[d][E]=y,t),r(t)},b=()=>{for(const d of Object.keys(t))for(const E of Object.keys(t[d])){const y=Math.floor(Math.random()*5)-2;l(0,t[d][E]=y,t)}r(t)},u=()=>{const d=Math.floor(Math.random()*m.length),E=m[d],y=Math.floor(Math.random()*m.length),B=m[y],V=Math.floor(Math.random()*5)-2;l(0,t[E][B]=V,t),r(t)},v=()=>{for(const d of Object.keys(t))for(const E of Object.keys(t[d]))l(0,t[d][E]=0,t);r(t)},N=(d,E)=>_(d,E),T=(d,E)=>f(d,E),w=(d,E)=>h(d,E);return n.$$set=d=>{"attractionTable"in d&&l(0,t=d.attractionTable),"onUpdateTable"in d&&l(9,r=d.onUpdateTable)},[t,s,m,f,h,_,b,u,v,r,N,T,w]}class ul extends Oe{constructor(e){super(),Be(this,e,il,sl,ze,{attractionTable:0,onUpdateTable:9})}}function cl(n){let e,l,t,r,s,m,f,h,_;return{c(){e=g("div"),l=g("canvas"),t=P(),r=g("label"),s=S("Limit FPS"),m=P(),f=g("input"),this.h()},l(b){e=p(b,"DIV",{class:!0});var u=M(e);l=p(u,"CANVAS",{id:!0,class:!0}),M(l).forEach(c),t=I(u),r=p(u,"LABEL",{for:!0});var v=M(r);s=C(v,"Limit FPS"),v.forEach(c),m=I(u),f=p(u,"INPUT",{id:!0,type:!0,min:!0}),u.forEach(c),this.h()},h(){z(l,"id","canvas"),z(l,"class","svelte-bkdgvm"),z(r,"for","maxFPSInput"),z(f,"id","maxFPSInput"),z(f,"type","number"),z(f,"min","1"),z(e,"class","container svelte-bkdgvm")},m(b,u){j(b,e,u),o(e,l),o(e,t),o(e,r),o(r,s),o(e,m),o(e,f),$(f,n[1]),h||(_=[R(f,"input",n[8]),R(f,"change",n[9])],h=!0)},p(b,[u]){u&2&&te(f.value)!==b[1]&&$(f,b[1])},i:re,o:re,d(b){b&&c(e),h=!1,Re(_)}}}function hl(n,e,l){let{cellSize:t}=e,{cells:r}=e,{worldSize:s}=e,{drewFrame:m}=e,{showColors:f}=e,h;const _=["white","red","green","blue"],b={white:0,red:1,green:2,blue:3},u={white:"#ffedff",red:"#fc2a51",green:"#8ff97c",blue:"#77cfff",background:"#383b3d"},v=_.length,N=t,T=N*2;let w=25,d=w,E,y,B,V;function A(){const a=document.getElementById("canvas");if(!a||!h)throw new Error("Canvas is not ready");if(window.requestAnimationFrame(A),B=Date.now(),V=B-y,V<=E)return;y=B-V%E;const D=a.getContext("2d");if(!D)throw new Error("Ctx is not ready");if(D.fillStyle=u.background,D.fillRect(0,0,a.width,a.height),!r?.length){window.requestAnimationFrame(A);return}for(let H=0;H<r.length;H++){const G=r[H],Z=Math.floor(Dt(G.pos.x,0,s.x,0,a.width)),le=Math.floor(Dt(G.pos.y,0,s.y,0,a.height));var F=f?b[G.color]:0;const ue=F*T,ce=0,K=T,he=T,ee=Z-N,q=le-N,O=T,L=T;D.drawImage(h,ue,ce,K,he,ee,q,O,L)}m()}xt(()=>{const a=document.getElementById("canvas");if(!a)throw new Error("Canvas is not ready");a.width=1600,a.height=960,h=document.createElement("canvas"),h.width=v*T,h.height=T;const D=h.getContext("2d");if(!D)throw new Error("Offscreen canvas is not ready");for(var F=0;F<v;++F){const H=_[F],G=u[H];D.fillStyle=G,D.beginPath(),D.arc(F*T+N,N,N,0,2*Math.PI),D.closePath(),D.fill()}l(2,E=1e3/w),y=Date.now(),window.requestAnimationFrame(A)});function k(){d=te(this.value),l(1,d)}const W=()=>{l(0,w=d),l(2,E=1e3/w)};return n.$$set=a=>{"cellSize"in a&&l(3,t=a.cellSize),"cells"in a&&l(4,r=a.cells),"worldSize"in a&&l(5,s=a.worldSize),"drewFrame"in a&&l(6,m=a.drewFrame),"showColors"in a&&l(7,f=a.showColors)},[w,d,E,t,r,s,m,f,k,W]}class fl extends Oe{constructor(e){super(),Be(this,e,hl,cl,ze,{cellSize:3,cells:4,worldSize:5,drewFrame:6,showColors:7})}}const Yt=["white","red","green","blue"],dl=()=>{const n=Math.floor(Math.random()*Yt.length);return Yt[n]},bl=(n,e)=>{const l=[];for(let t=0;t<e;t++){const r={id:t,pos:{x:Math.random()*n.x,y:Math.random()*n.y},nextPos:{x:0,y:0},vel:{x:0,y:0},color:dl()};l.push(r)}return l};function ml(n){let e,l,t,r,s,m,f,h,_,b,u,v,N,T,w,d,E=n[8]*n[6]+"",y,B,V,A,k,W,a,D,F=n[9]*n[6]+"",H,G,Z,le,ue,ce,K,he,ee,q,O,L,J,ne,Ie=(n[1]?.length||0)-n[11]+"",Fe,lt,me,nt,Le,ot,_e,rt,De,at,Q,Ve,st,oe,ge,it,ut,pe,ct,ht,we,Ne=n[4]?"Play":"Pause",We,ft,Ue,ve,Ae=n[5]?"Hide colors":"Show colors",je,qe,Y,Te,dt,bt,Me,mt,_t,Ee,gt,pt,ke,wt,He,fe,Ze,ae,x,vt,kt;return ee=new fl({props:{cells:n[0],worldSize:n[10],cellSize:_l,showColors:n[5],drewFrame:n[19]}}),fe=new al({props:{updateTable:n[12]}}),ae=new ul({props:{attractionTable:n[2],onUpdateTable:n[12]}}),{c(){e=g("h2"),l=S("V3 WIP"),t=P(),r=g("div"),s=g("p"),m=g("label"),f=S("Simulation definition"),h=P(),_=g("input"),b=P(),u=g("p"),v=g("label"),N=S("Simulation horizontal resolution"),T=P(),w=g("input"),d=S(`
        = `),y=S(E),B=P(),V=g("p"),A=g("label"),k=S("Simulation vertical resolution"),W=P(),a=g("input"),D=S(`
        = `),H=S(F),G=P(),Z=g("p"),le=g("label"),ue=S("Number of particles"),ce=P(),K=g("input"),he=P(),Je(ee.$$.fragment),q=P(),O=g("div"),L=g("div"),J=g("span"),ne=S("Buffer size: "),Fe=S(Ie),lt=P(),me=g("span"),nt=S("Current frame: "),Le=S(n[11]),ot=P(),_e=g("span"),rt=S("Frame length (ms): "),De=S(n[3]),at=P(),Q=g("input"),st=P(),oe=g("div"),ge=g("button"),it=S("Replay from start"),ut=P(),pe=g("button"),ct=S("Catchup last frame"),ht=P(),we=g("button"),We=S(Ne),ft=P(),Ue=g("div"),ve=g("button"),je=S(Ae),qe=P(),Y=g("div"),Te=g("button"),dt=S("Reset cells"),bt=P(),Me=g("button"),mt=S("Center cells"),_t=P(),Ee=g("button"),gt=S("Large Center cells"),pt=P(),ke=g("button"),wt=S("Rainbow cells"),He=P(),Je(fe.$$.fragment),Ze=P(),Je(ae.$$.fragment),this.h()},l(i){e=p(i,"H2",{});var U=M(e);l=C(U,"V3 WIP"),U.forEach(c),t=I(i),r=p(i,"DIV",{});var X=M(r);s=p(X,"P",{});var de=M(s);m=p(de,"LABEL",{for:!0});var yt=M(m);f=C(yt,"Simulation definition"),yt.forEach(c),h=I(de),_=p(de,"INPUT",{id:!0,type:!0}),de.forEach(c),b=I(X),u=p(X,"P",{});var ye=M(u);v=p(ye,"LABEL",{for:!0});var St=M(v);N=C(St,"Simulation horizontal resolution"),St.forEach(c),T=I(ye),w=p(ye,"INPUT",{id:!0,type:!0}),d=C(ye,`
        = `),y=C(ye,E),ye.forEach(c),B=I(X),V=p(X,"P",{});var Se=M(V);A=p(Se,"LABEL",{for:!0});var Ct=M(A);k=C(Ct,"Simulation vertical resolution"),Ct.forEach(c),W=I(Se),a=p(Se,"INPUT",{id:!0,type:!0}),D=C(Se,`
        = `),H=C(Se,F),Se.forEach(c),G=I(X),Z=p(X,"P",{});var Ge=M(Z);le=p(Ge,"LABEL",{for:!0});var Pt=M(le);ue=C(Pt,"Number of particles"),Pt.forEach(c),ce=I(Ge),K=p(Ge,"INPUT",{id:!0,type:!0}),Ge.forEach(c),X.forEach(c),he=I(i),Ke(ee.$$.fragment,i),q=I(i),O=p(i,"DIV",{});var se=M(O);L=p(se,"DIV",{});var Ce=M(L);J=p(Ce,"SPAN",{});var Tt=M(J);ne=C(Tt,"Buffer size: "),Fe=C(Tt,Ie),Tt.forEach(c),lt=I(Ce),me=p(Ce,"SPAN",{});var Mt=M(me);nt=C(Mt,"Current frame: "),Le=C(Mt,n[11]),Mt.forEach(c),ot=I(Ce),_e=p(Ce,"SPAN",{});var Et=M(_e);rt=C(Et,"Frame length (ms): "),De=C(Et,n[3]),Et.forEach(c),Ce.forEach(c),at=I(se),Q=p(se,"INPUT",{type:!0,min:!0,max:!0,class:!0,id:!0}),st=I(se),oe=p(se,"DIV",{});var Pe=M(oe);ge=p(Pe,"BUTTON",{});var It=M(ge);it=C(It,"Replay from start"),It.forEach(c),ut=I(Pe),pe=p(Pe,"BUTTON",{});var Nt=M(pe);ct=C(Nt,"Catchup last frame"),Nt.forEach(c),ht=I(Pe),we=p(Pe,"BUTTON",{});var Ut=M(we);We=C(Ut,Ne),Ut.forEach(c),Pe.forEach(c),ft=I(se),Ue=p(se,"DIV",{});var At=M(Ue);ve=p(At,"BUTTON",{});var Ot=M(ve);je=C(Ot,Ae),Ot.forEach(c),At.forEach(c),se.forEach(c),qe=I(i),Y=p(i,"DIV",{});var ie=M(Y);Te=p(ie,"BUTTON",{});var Bt=M(Te);dt=C(Bt,"Reset cells"),Bt.forEach(c),bt=I(ie),Me=p(ie,"BUTTON",{});var zt=M(Me);mt=C(zt,"Center cells"),zt.forEach(c),_t=I(ie),Ee=p(ie,"BUTTON",{});var Rt=M(Ee);gt=C(Rt,"Large Center cells"),Rt.forEach(c),pt=I(ie),ke=p(ie,"BUTTON",{});var Ft=M(ke);wt=C(Ft,"Rainbow cells"),Ft.forEach(c),ie.forEach(c),He=I(i),Ke(fe.$$.fragment,i),Ze=I(i),Ke(ae.$$.fragment,i),this.h()},h(){z(m,"for","attractionRadius"),z(_,"id","attractionRadius"),z(_,"type","number"),z(v,"for","horizontalResolution"),z(w,"id","horizontalResolution"),z(w,"type","number"),z(A,"for","verticalResolution"),z(a,"id","verticalResolution"),z(a,"type","number"),z(le,"for","nbParticles"),z(K,"id","nbParticles"),z(K,"type","number"),z(Q,"type","range"),z(Q,"min","1"),z(Q,"max",Ve=n[1]?.length?n[1].length-1:0),z(Q,"class","slider"),z(Q,"id","frameIndexSlider")},m(i,U){j(i,e,U),o(e,l),j(i,t,U),j(i,r,U),o(r,s),o(s,m),o(m,f),o(s,h),o(s,_),$(_,n[6]),o(r,b),o(r,u),o(u,v),o(v,N),o(u,T),o(u,w),$(w,n[8]),o(u,d),o(u,y),o(r,B),o(r,V),o(V,A),o(A,k),o(V,W),o(V,a),$(a,n[9]),o(V,D),o(V,H),o(r,G),o(r,Z),o(Z,le),o(le,ue),o(Z,ce),o(Z,K),$(K,n[7]),j(i,he,U),Qe(ee,i,U),j(i,q,U),j(i,O,U),o(O,L),o(L,J),o(J,ne),o(J,Fe),o(L,lt),o(L,me),o(me,nt),o(me,Le),o(L,ot),o(L,_e),o(_e,rt),o(_e,De),o(O,at),o(O,Q),$(Q,n[11]),o(O,st),o(O,oe),o(oe,ge),o(ge,it),o(oe,ut),o(oe,pe),o(pe,ct),o(oe,ht),o(oe,we),o(we,We),o(O,ft),o(O,Ue),o(Ue,ve),o(ve,je),j(i,qe,U),j(i,Y,U),o(Y,Te),o(Te,dt),o(Y,bt),o(Y,Me),o(Me,mt),o(Y,_t),o(Y,Ee),o(Ee,gt),o(Y,pt),o(Y,ke),o(ke,wt),j(i,He,U),Qe(fe,i,U),j(i,Ze,U),Qe(ae,i,U),x=!0,vt||(kt=[R(_,"input",n[20]),R(_,"change",n[13]),R(w,"input",n[21]),R(w,"change",n[13]),R(a,"input",n[22]),R(a,"change",n[13]),R(K,"input",n[23]),R(K,"change",n[13]),R(Q,"change",n[24]),R(Q,"input",n[24]),R(ge,"click",n[18]),R(pe,"click",n[25]),R(we,"click",n[26]),R(ve,"click",n[27]),R(Te,"click",n[17]),R(Me,"click",n[14]),R(Ee,"click",n[15]),R(ke,"click",n[16])],vt=!0)},p(i,U){U[0]&64&&te(_.value)!==i[6]&&$(_,i[6]),U[0]&256&&te(w.value)!==i[8]&&$(w,i[8]),(!x||U[0]&320)&&E!==(E=i[8]*i[6]+"")&&be(y,E),U[0]&512&&te(a.value)!==i[9]&&$(a,i[9]),(!x||U[0]&576)&&F!==(F=i[9]*i[6]+"")&&be(H,F),U[0]&128&&te(K.value)!==i[7]&&$(K,i[7]);const X={};U[0]&1&&(X.cells=i[0]),U[0]&1024&&(X.worldSize=i[10]),U[0]&32&&(X.showColors=i[5]),ee.$set(X),(!x||U[0]&2050)&&Ie!==(Ie=(i[1]?.length||0)-i[11]+"")&&be(Fe,Ie),(!x||U[0]&2048)&&be(Le,i[11]),(!x||U[0]&8)&&be(De,i[3]),(!x||U[0]&2&&Ve!==(Ve=i[1]?.length?i[1].length-1:0))&&z(Q,"max",Ve),U[0]&2048&&$(Q,i[11]),(!x||U[0]&16)&&Ne!==(Ne=i[4]?"Play":"Pause")&&be(We,Ne),(!x||U[0]&32)&&Ae!==(Ae=i[5]?"Hide colors":"Show colors")&&be(je,Ae);const de={};U[0]&4&&(de.attractionTable=i[2]),ae.$set(de)},i(i){x||(Xe(ee.$$.fragment,i),Xe(fe.$$.fragment,i),Xe(ae.$$.fragment,i),x=!0)},o(i){Ye(ee.$$.fragment,i),Ye(fe.$$.fragment,i),Ye(ae.$$.fragment,i),x=!1},d(i){i&&c(e),i&&c(t),i&&c(r),i&&c(he),xe(ee,i),i&&c(q),i&&c(O),i&&c(qe),i&&c(Y),i&&c(He),xe(fe,i),i&&c(Ze),xe(ae,i),vt=!1,Re(kt)}}}const _l=1;function gl(n,e,l){let t,r,s,m,f=0,h=0,_=!1,b=!0,u=32,v=4e3,N=30,T=20;const w={x:u*N,y:u*T};let d;const E=async()=>{d=(await nl(()=>import("../../chunks/simulation.worker-6ca7b434.js"),[],import.meta.url)).default,a()},y=q=>{l(2,m=q),t.postMessage({msg:"updateTable",attractionTable:m}),l(1,s=[r.map(O=>O.pos)]),l(11,F=0)},B=()=>{l(10,w.x=u*N,w),l(10,w.y=u*T,w),a()},V=()=>{for(const q of r){const O=2*Math.random(),L=Math.random()*2*Math.PI,J=w.x/2+O*Math.cos(L),ne=w.y/2+O*Math.sin(L);q.pos={x:J,y:ne}}a(!0,!0)},A=()=>{for(const q of r){const O=200*Math.random(),L=Math.random()*2*Math.PI,J=w.x/2+O*Math.cos(L),ne=w.y/2+O*Math.sin(L);q.pos={x:J,y:ne}}a(!0,!0)},k=()=>{const q=["white","red","green","blue"],O=w.x/4;for(const L of r){const J=Math.floor(L.pos.x/O),ne=q[J];L.color=ne}a(!0,!0)},W=()=>{a(!1,!0)},a=(q,O)=>{if(d===void 0)throw new Error("Worker is not initialized");t&&(t.postMessage({msg:"destroy"}),t.terminate()),t=new d;const L=J=>{s.push(J.data.positions)};t.onmessage=L,q||l(0,r=bl(w,v)),O||l(2,m=$t()),l(1,s=[]),l(11,F=0),t.postMessage({msg:"start",cells:r,attractionTable:m,worldSize:w,maxAttractionRadius:u})},D=()=>{l(11,F=0)};let F=0;const H=()=>{if(s.length-1>F){const q=Date.now();l(3,h=q-f),f=q,_||l(11,F++,F);const O=s[F];if(l(1,s),O.length!==r.length)return;for(let L=0;L<r.length;L++)l(0,r[L].pos=O[L],r)}};xt(E),ll(()=>t?.terminate());function G(){u=te(this.value),l(6,u)}function Z(){N=te(this.value),l(8,N)}function le(){T=te(this.value),l(9,T)}function ue(){v=te(this.value),l(7,v)}function ce(){F=te(this.value),l(11,F)}return[r,s,m,h,_,b,u,v,N,T,w,F,y,B,V,A,k,W,D,H,G,Z,le,ue,ce,()=>l(11,F=s.length-1||0),()=>l(4,_=!_),()=>l(5,b=!b)]}class pl extends Oe{constructor(e){super(),Be(this,e,gl,ml,ze,{},null,[-1,-1])}}function wl(n){let e,l;return e=new pl({}),{c(){Je(e.$$.fragment)},l(t){Ke(e.$$.fragment,t)},m(t,r){Qe(e,t,r),l=!0},p:re,i(t){l||(Xe(e.$$.fragment,t),l=!0)},o(t){Ye(e.$$.fragment,t),l=!1},d(t){xe(e,t)}}}class Ml extends Oe{constructor(e){super(),Be(this,e,null,wl,ze,{})}}export{Ml as default};
