import{S as G,i as Q,s as X,k as S,l as M,m as I,h as _,n as O,b as U,D as h,B as F,o as st,w as W,a as P,q as N,x as H,c as k,r as V,y as j,I as q,u as at,f as J,t as K,z as L,J as lt,K as rt}from"../../chunks/index-689c9b92.js";import{l as nt,g as ct,u as it}from"../../chunks/cells-3d58d19f.js";import{A as ft,g as ut}from"../../chunks/AttractionTableComponent-c88af04d.js";import{A as dt}from"../../chunks/AttractionTableChoice-fc32f805.js";function mt(i){let t,e;return{c(){t=S("div"),e=S("canvas"),this.h()},l(o){t=M(o,"DIV",{class:!0});var n=I(t);e=M(n,"CANVAS",{id:!0,class:!0}),I(e).forEach(_),n.forEach(_),this.h()},h(){O(e,"id","canvas"),O(e,"class","svelte-bkdgvm"),O(t,"class","container svelte-bkdgvm")},m(o,n){U(o,t,n),h(t,e)},p:F,i:F,o:F,d(o){o&&_(t)}}}const R=3;function ht(i,t,e){let{cells:o}=t,{worldSize:n}=t,r;const p=["white","red","green","blue"],u={white:0,red:1,green:2,blue:3},b=p.length,d=R*2;function w(){const c=document.getElementById("canvas");if(!c||!r)throw new Error("Canvas is not ready");const a=c.getContext("2d");if(!a)throw new Error("Ctx is not ready");if(a.fillStyle="#040411",a.fillRect(0,0,c.width,c.height),!o?.length){window.requestAnimationFrame(w);return}const m=3,x=[...o].sort((l,f)=>u[l.color]-u[f.color]);for(let l=0;l<x.length;l++){const f=x[l],$=Math.floor(nt(f.pos.x,0,n.x,0,c.width)),g=Math.floor(nt(f.pos.y,0,n.y,0,c.height));(l===0||f.color!==x[l-1].color)&&(a.fill(),a.fillStyle=f.color),a.beginPath(),a.arc($,g,m,0,2*Math.PI),a.closePath();var z=u[f.color];const E=z*d,T=0,A=d,B=d,D=$-R,s=g-R,v=d,y=d;a.drawImage(r,E,T,A,B,D,s,v,y)}a.fill(),window.requestAnimationFrame(w)}return st(()=>{const c=document.getElementById("canvas");if(!c)throw new Error("Canvas is not ready");c.width=1600,c.height=960,r=document.createElement("canvas"),r.width=b*d,r.height=d;const a=r.getContext("2d");if(!a)throw new Error("Offscreen canvas is not ready");for(var m=0;m<b;++m)a.fillStyle=p[m],a.beginPath(),a.arc(m*d+R,R,R,0,2*Math.PI),a.closePath(),a.fill();window.requestAnimationFrame(w)}),i.$$set=c=>{"cells"in c&&e(0,o=c.cells),"worldSize"in c&&e(1,n=c.worldSize)},[o,n]}class pt extends G{constructor(t){super(),Q(this,t,ht,mt,X,{cells:0,worldSize:1})}}function gt(i){let t,e,o,n,r,p,u=i[3].pause?"Run":"Pause",b,d,w,c,a,m,x,z,l,f,$,g,E,T,A,B,D;return e=new pt({props:{cells:i[0],worldSize:i[1]?.worldSize}}),g=new dt({props:{updateTable:i[5]}}),T=new ft({props:{attractionTable:i[2],onUpdateTable:i[5]}}),{c(){t=S("div"),W(e.$$.fragment),o=P(),n=S("div"),r=S("div"),p=S("button"),b=N(u),d=P(),w=S("button"),c=N("Reset cells"),a=P(),m=S("button"),x=N("Rainbow"),z=P(),l=S("button"),f=N("Center"),$=P(),W(g.$$.fragment),E=P(),W(T.$$.fragment),this.h()},l(s){t=M(s,"DIV",{class:!0});var v=I(t);H(e.$$.fragment,v),v.forEach(_),o=k(s),n=M(s,"DIV",{});var y=I(n);r=M(y,"DIV",{});var C=I(r);p=M(C,"BUTTON",{});var Y=I(p);b=V(Y,u),Y.forEach(_),d=k(C),w=M(C,"BUTTON",{});var Z=I(w);c=V(Z,"Reset cells"),Z.forEach(_),a=k(C),m=M(C,"BUTTON",{});var tt=I(m);x=V(tt,"Rainbow"),tt.forEach(_),z=k(C),l=M(C,"BUTTON",{});var et=I(l);f=V(et,"Center"),et.forEach(_),C.forEach(_),$=k(y),H(g.$$.fragment,y),E=k(y),H(T.$$.fragment,y),y.forEach(_),this.h()},h(){O(t,"class","d-flex justify-content-center")},m(s,v){U(s,t,v),j(e,t,null),U(s,o,v),U(s,n,v),h(n,r),h(r,p),h(p,b),h(r,d),h(r,w),h(w,c),h(r,a),h(r,m),h(m,x),h(r,z),h(r,l),h(l,f),h(n,$),j(g,n,null),h(n,E),j(T,n,null),A=!0,B||(D=[q(p,"click",i[8]),q(w,"click",i[4]),q(m,"click",i[6]),q(l,"click",i[7])],B=!0)},p(s,[v]){const y={};v&1&&(y.cells=s[0]),v&2&&(y.worldSize=s[1]?.worldSize),e.$set(y),(!A||v&8)&&u!==(u=s[3].pause?"Run":"Pause")&&at(b,u);const C={};v&4&&(C.attractionTable=s[2]),T.$set(C)},i(s){A||(J(e.$$.fragment,s),J(g.$$.fragment,s),J(T.$$.fragment,s),A=!0)},o(s){K(e.$$.fragment,s),K(g.$$.fragment,s),K(T.$$.fragment,s),A=!1},d(s){s&&_(t),L(e),s&&_(o),s&&_(n),L(g),L(T),B=!1,lt(D)}}}const ot=32;function wt(i,t,e){let o,n,r,p;const u={pause:!1},b={x:1600,y:960},d=()=>{const l=ct(b,2e3,ot);e(0,n=l.cells),e(1,r=l.cellsMap)};let w;const c=()=>{u.pause===!1&&it(p,ot,n,r),w=setTimeout(c,1)},a=l=>{e(2,p=l)},m=()=>{const l=["white","red","green","blue"],f=b.x/4;for(const $ of n){const g=Math.floor($.pos.x/f),E=l[g];$.color=E}},x=()=>{for(const l of n){const f=2*Math.random(),$=Math.random()*2*Math.PI,g=b.x/2+f*Math.cos($),E=b.y/2+f*Math.sin($);l.pos={x:g,y:E}}};return st(()=>{d(),e(2,p=ut()),c()}),rt(()=>{o?.remove(),clearTimeout(w)}),[n,r,p,u,d,a,m,x,()=>e(3,u.pause=!u.pause,u)]}class vt extends G{constructor(t){super(),Q(this,t,wt,gt,X,{})}}function _t(i){let t,e;return t=new vt({}),{c(){W(t.$$.fragment)},l(o){H(t.$$.fragment,o)},m(o,n){j(t,o,n),e=!0},p:F,i(o){e||(J(t.$$.fragment,o),e=!0)},o(o){K(t.$$.fragment,o),e=!1},d(o){L(t,o)}}}class Tt extends G{constructor(t){super(),Q(this,t,null,_t,X,{})}}export{Tt as default};
