import{S as G,i as Q,s as X,k as E,l as M,m as I,h as _,n as O,b as U,D as h,B as F,o as st,w as W,a as P,q as N,x as H,c as k,r as V,y as j,I as q,u as at,f as J,t as K,z as L,J as lt,K as rt}from"../../chunks/index-689c9b92.js";import{l as nt,g as ct,u as it}from"../../chunks/cells-3d58d19f.js";import{A as ft,g as ut}from"../../chunks/AttractionTableComponent-c88af04d.js";import{A as dt}from"../../chunks/AttractionTableChoice-fc32f805.js";function mt(i){let t,e;return{c(){t=E("div"),e=E("canvas"),this.h()},l(o){t=M(o,"DIV",{class:!0});var n=I(t);e=M(n,"CANVAS",{id:!0,class:!0}),I(e).forEach(_),n.forEach(_),this.h()},h(){O(e,"id","canvas"),O(e,"class","svelte-bkdgvm"),O(t,"class","container svelte-bkdgvm")},m(o,n){U(o,t,n),h(t,e)},p:F,i:F,o:F,d(o){o&&_(t)}}}const R=3;function ht(i,t,e){let{cells:o}=t,{worldSize:n}=t,r;const g=["white","red","green","blue"],u={white:0,red:1,green:2,blue:3},b=g.length,d=R*2;function v(){const a=document.getElementById("canvas");if(!a||!r)throw new Error("Canvas is not ready");const c=a.getContext("2d");if(c.fillStyle="#040411",c.fillRect(0,0,a.width,a.height),!o?.length){window.requestAnimationFrame(v);return}const m=3,x=[...o].sort((l,f)=>u[l.color]-u[f.color]);for(let l=0;l<x.length;l++){const f=x[l],$=Math.floor(nt(f.pos.x,0,n.x,0,a.width)),p=Math.floor(nt(f.pos.y,0,n.y,0,a.height));(l===0||f.color!==x[l-1].color)&&(c.fill(),c.fillStyle=f.color),c.beginPath(),c.arc($,p,m,0,2*Math.PI),c.closePath();var z=u[f.color];const S=z*d,T=0,A=d,B=d,D=$-R,s=p-R,w=d,y=d;c.drawImage(r,S,T,A,B,D,s,w,y)}c.fill(),window.requestAnimationFrame(v)}return st(()=>{const a=document.getElementById("canvas");if(!a)throw new Error("Canvas is not ready");a.getContext("2d"),a.width=1600,a.height=960,r=document.createElement("canvas"),r.width=b*d,r.height=d;const c=r.getContext("2d");if(!c)throw new Error("Offscreen canvas is not ready");for(var m=0;m<b;++m)c.fillStyle=g[m],c.beginPath(),c.arc(m*d+R,R,R,0,2*Math.PI),c.closePath(),c.fill();window.requestAnimationFrame(v)}),i.$$set=a=>{"cells"in a&&e(0,o=a.cells),"worldSize"in a&&e(1,n=a.worldSize)},[o,n]}class gt extends G{constructor(t){super(),Q(this,t,ht,mt,X,{cells:0,worldSize:1})}}function pt(i){let t,e,o,n,r,g,u=i[3].pause?"Run":"Pause",b,d,v,a,c,m,x,z,l,f,$,p,S,T,A,B,D;return e=new gt({props:{cells:i[0],worldSize:i[1]?.worldSize}}),p=new dt({props:{updateTable:i[5]}}),T=new ft({props:{attractionTable:i[2],onUpdateTable:i[5]}}),{c(){t=E("div"),W(e.$$.fragment),o=P(),n=E("div"),r=E("div"),g=E("button"),b=N(u),d=P(),v=E("button"),a=N("Reset cells"),c=P(),m=E("button"),x=N("Rainbow"),z=P(),l=E("button"),f=N("Center"),$=P(),W(p.$$.fragment),S=P(),W(T.$$.fragment),this.h()},l(s){t=M(s,"DIV",{class:!0});var w=I(t);H(e.$$.fragment,w),w.forEach(_),o=k(s),n=M(s,"DIV",{});var y=I(n);r=M(y,"DIV",{});var C=I(r);g=M(C,"BUTTON",{});var Y=I(g);b=V(Y,u),Y.forEach(_),d=k(C),v=M(C,"BUTTON",{});var Z=I(v);a=V(Z,"Reset cells"),Z.forEach(_),c=k(C),m=M(C,"BUTTON",{});var tt=I(m);x=V(tt,"Rainbow"),tt.forEach(_),z=k(C),l=M(C,"BUTTON",{});var et=I(l);f=V(et,"Center"),et.forEach(_),C.forEach(_),$=k(y),H(p.$$.fragment,y),S=k(y),H(T.$$.fragment,y),y.forEach(_),this.h()},h(){O(t,"class","d-flex justify-content-center")},m(s,w){U(s,t,w),j(e,t,null),U(s,o,w),U(s,n,w),h(n,r),h(r,g),h(g,b),h(r,d),h(r,v),h(v,a),h(r,c),h(r,m),h(m,x),h(r,z),h(r,l),h(l,f),h(n,$),j(p,n,null),h(n,S),j(T,n,null),A=!0,B||(D=[q(g,"click",i[8]),q(v,"click",i[4]),q(m,"click",i[6]),q(l,"click",i[7])],B=!0)},p(s,[w]){const y={};w&1&&(y.cells=s[0]),w&2&&(y.worldSize=s[1]?.worldSize),e.$set(y),(!A||w&8)&&u!==(u=s[3].pause?"Run":"Pause")&&at(b,u);const C={};w&4&&(C.attractionTable=s[2]),T.$set(C)},i(s){A||(J(e.$$.fragment,s),J(p.$$.fragment,s),J(T.$$.fragment,s),A=!0)},o(s){K(e.$$.fragment,s),K(p.$$.fragment,s),K(T.$$.fragment,s),A=!1},d(s){s&&_(t),L(e),s&&_(o),s&&_(n),L(p),L(T),B=!1,lt(D)}}}const ot=32;function vt(i,t,e){let o,n,r,g;const u={pause:!1},b={x:1600,y:960},d=()=>{const l=ct(b,2e3,ot);e(0,n=l.cells),e(1,r=l.cellsMap)};let v;const a=()=>{u.pause===!1&&it(g,ot,n,r),v=setTimeout(a,1)},c=l=>{e(2,g=l)},m=()=>{const l=["white","red","green","blue"],f=b.x/4;for(const $ of n){const p=Math.floor($.pos.x/f),S=l[p];$.color=S}},x=()=>{for(const l of n){const f=2*Math.random(),$=Math.random()*2*Math.PI,p=b.x/2+f*Math.cos($),S=b.y/2+f*Math.sin($);l.pos={x:p,y:S}}};return st(()=>{d(),e(2,g=ut()),a()}),rt(()=>{o?.remove(),clearTimeout(v)}),[n,r,g,u,d,c,m,x,()=>e(3,u.pause=!u.pause,u)]}class wt extends G{constructor(t){super(),Q(this,t,vt,pt,X,{})}}function _t(i){let t,e;return t=new wt({}),{c(){W(t.$$.fragment)},l(o){H(t.$$.fragment,o)},m(o,n){j(t,o,n),e=!0},p:F,i(o){e||(J(t.$$.fragment,o),e=!0)},o(o){K(t.$$.fragment,o),e=!1},d(o){L(t,o)}}}class Tt extends G{constructor(t){super(),Q(this,t,null,_t,X,{})}}export{Tt as default};
